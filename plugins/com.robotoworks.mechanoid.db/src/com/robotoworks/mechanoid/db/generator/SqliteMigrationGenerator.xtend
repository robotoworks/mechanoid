package com.robotoworks.mechanoid.db.generator

import com.google.inject.Inject
import com.robotoworks.mechanoid.db.sqliteModel.MigrationBlock
import com.robotoworks.mechanoid.db.sqliteModel.Model

import static extension com.robotoworks.mechanoid.text.Strings.*

class SqliteMigrationGenerator {
	
		@Inject extension SqliteDatabaseStatementGenerator
		
		def CharSequence generate(Model model, MigrationBlock migration, int version) '''
			/*
			 * Generated by Robotoworks Mechanoid
			 */
			package «model.packageName».migrations;
			
			import android.database.sqlite.SQLiteDatabase;
			import com.robotoworks.mechanoid.db.SQLiteMigration;
			
			public class Default«model.database.name.pascalize»MigrationV«version» extends SQLiteMigration {
				@Override
				public void onBeforeUp(SQLiteDatabase db) {}
				
				@Override
				public void up(SQLiteDatabase db) {
					«migration.statements.generateStatements»
				}
				
				@Override
				public void onAfterUp(SQLiteDatabase db) {}
			}
			'''
}